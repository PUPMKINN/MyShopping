<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/register.css">
    <link rel="stylesheet" href="/assets/fonts/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Document</title>
</head>

<body>
    <div class="container">


        <div class="wrapper-header">
            <div class="create-interface row">
                <div class="col-6  content-create">
                    <div class="create">
                        <div class="header-create">
                            <div class="square"> </div>
                            <div class="app-name">TUS</div>
                        </div>

                        <div class="register">Sign Up</div>
                    </div>
                    <div class="wrapper-content-create">

                        <div class="instruction">Fill full these input to create a new account <i class="ti-bell"></i>
                        </div>

                        <form class="modal-content" action="" method="POST">

                            <div class="input-content">
                                <div class="wrapper-input">
                                    <div class="input">
                                        <i class="ti-user"></i>
                                        <div class="input-data">
                                            <input type="text" class="input-user" id="input-username" placeholder="User"
                                                name="username">
                                        </div>
                                    </div>
                                    <div class="error"> error</div>

                                </div>


                                <div class="wrapper-input">
                                    <div class="input">
                                        <i class="ti-lock"></i>
                                        <div class="input-data">
                                            <input type="password" class="input-password" id="input-password"
                                                placeholder="Password" name="password">
                                        </div>
                                    </div>
                                    <div class="error"> error</div>
                                </div>
                                <div class="wrapper-input">
                                    <div class="input">
                                        <i class="ti-lock"></i>
                                        <div class="input-data">
                                            <input type="password" class="input-confirm-password"
                                                id="input-confirm-password" placeholder="Confirm Password"
                                                name="passwordConfirmation">
                                        </div>
                                    </div>
                                    <div class="error"> error</div>
                                </div>
                                <div class="wrapper-input">
                                    <div class="input">
                                        <i class="ti-email"></i>
                                        <div class="input-data">

                                            <input type="email" class="input-email" id="input-email" placeholder="Email"
                                                name="email">
                                        </div>

                                    </div>
                                    <div class="error"> error</div>
                                </div>
                            </div>

                        </form>
                        <div class="text-policy">By creating an account you agree to our <a href="#"
                                style="color:dodgerblue">Terms &
                                Privacy</a>.
                        </div>
                        <div class="choose">
                            <label for="checkbox-accept-policy" class="checkbox-container">
                                <input type="checkbox" id="checkbox-accept-policy" name="checkbox-accept-policy">
                                <span class="checkmark"></span>Agree Policies
                            </label>
                        </div>
                        <div class="clearfix">

                            <button type="submit" class="signupbtn">Sign Up</button>
                            <button type="button" class="cancelbtn">Cancel</button>
                        </div>
                    </div>


                </div>
                <div class="discriptions col-6">
                    <div class="wrapper-logo">
                        <img class="logo" src="assets\img\logo.png" alt="">
                    </div>

                    <div class="wrapper-discriptions">
                        <div class="discription">
                            <div class="header-discription">
                                <div class="circle">
                                    <div class="tick"></div>
                                </div>
                                <div class="text">
                                    <div class="text-header-discription">Flexibility</div>
                                    <div class="text-discription">A flexible timetable with a variety of different class
                                        schedules
                                        allows users
                                        to choose what suits them best.
                                    </div>
                                    <div class="seperator"></div>
                                </div>

                            </div>

                        </div>
                        <div class="discription">
                            <div class="header-discription">
                                <div class="circle">
                                    <div class="tick"></div>
                                </div>
                                <div class="text">
                                    <div class="text-header-discription">The reliability</div>
                                    <div class="text-discription">The tutoring tream is always meticulously screened
                                        based on their GPA and evaluations form students.
                                    </div>
                                    <div class="seperator"></div>
                                </div>

                            </div>

                        </div>
                        <div class="discription">
                            <div class="header-discription">
                                <div class="circle">
                                    <div class="tick"></div>
                                </div>
                                <div class="text">
                                    <div class="text-header-discription">The suitability</div>
                                    <div class="text-discription">
                                        The platform is formed based on the need to enhance the academic performance of
                                        HCMUS
                                        students,
                                        so the courses will be more suitable and closely aligned with the curriculum of
                                        the
                                        university than anywhere else.
                                    </div>

                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>


    </div>



    </div>

    </div>
    <script>
        const $ = document.querySelector.bind(document)
        const $$ = document.querySelectorAll.bind(document)

        var createAccountBtn = document.querySelector('.signupbtn')
        var cancelBtn = document.querySelector('.clearfix .cancelbtn')



        cancelBtn.addEventListener("click", function () {
            window.location.href = "/login";

        })

        createAccountBtn.addEventListener("click", async function (event) {
            event.preventDefault(); // Prevent the form from submitting automatically
            const curUrl = new URL(window.location.href);
            let isError = false;
            // Collect data from the form
            const formData = {
                'email': $('#input-email').value,
                'username': $('#input-username').value,
                'password': $('#input-password').value,
                'passwordConfirmation': $('#input-confirm-password').value,
            };

            console.log(formData);

            fetch('/signup', {
                method: 'POST',
                body: JSON.stringify(formData),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
            }).then(response => {
                if (!response.ok) {
                    isError = true;
                    // Handle errors here, e.g., display an error message

                }
                // If signup was successful, redirect to the signin page
                return response.json();
            })
                .then(data => {
                    if (isError == true) {
                        const errorElements = $$('.error');

                        errorElements.forEach(errorElement => {
                            errorElement.classList.remove('active');
                        });
                        errorElements.forEach(errorElement => {
                            const fieldName = errorElement.previousElementSibling.lastElementChild.lastElementChild.getAttribute('name');
                            console.log(fieldName)
                            if (data.errors.some(error => error.path === fieldName)) {
                                errorElement.classList.add('active');
                                const matchingError = data.errors.find(error => error.path === fieldName);
                                errorElement.innerHTML = matchingError.msg;
                            }
                        });
                    } else {
                        // Redirect to the signin page (adjust the URL as needed)
                        window.location.href = '/signin';
                    }

                })
                .catch(error => {
                    // Handle other errors here
                    console.error('Error:', error);
                });

        });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
</body>

</html>